{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _Object$keys2 from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport Immutable from 'immutable';\nimport thunkMiddleware from 'redux-thunk';\nimport { createLogger } from 'redux-logger';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport { createStore, applyMiddleware } from 'redux';\nimport config from \"../config\";\nimport rootReducer from \"../reducers\";\n\nfunction createMiddlewares(_ref) {\n  var isServer = _ref.isServer;\n  var middlewares = [thunkMiddleware];\n\n  if (config.env === 'development' && true) {\n    middlewares.push(createLogger({\n      level: 'info',\n      collapsed: true,\n      stateTransformer: function stateTransformer(state) {\n        var newState = {};\n\n        for (var _i = 0, _Object$keys = _Object$keys2(state); _i < _Object$keys.length; _i++) {\n          var i = _Object$keys[_i];\n\n          if (Immutable.Iterable.isIterable(state[i])) {\n            newState[i] = state[i].toJS();\n          } else {\n            newState[i] = state[i];\n          }\n        }\n\n        return newState;\n      }\n    }));\n  }\n\n  return middlewares;\n}\n\nfunction immutableChildren(obj) {\n  var state = {};\n\n  _Object$keys2(obj).forEach(function (key) {\n    state[key] = Immutable.fromJS(obj[key]);\n  });\n\n  return state;\n}\n\nexport default (function () {\n  var initialState = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var context = arguments.length > 1 ? arguments[1] : undefined;\n  var isServer = context.isServer;\n  var middlewares = createMiddlewares({\n    isServer: isServer\n  });\n  var state = immutableChildren(initialState);\n  return createStore(rootReducer, state, composeWithDevTools(applyMiddleware.apply(void 0, _toConsumableArray(middlewares))));\n});","map":{"version":3,"sources":["D:/jotter/src/store/createStore.js"],"names":["Immutable","thunkMiddleware","createLogger","composeWithDevTools","createStore","applyMiddleware","config","rootReducer","createMiddlewares","isServer","middlewares","env","push","level","collapsed","stateTransformer","state","newState","i","Iterable","isIterable","toJS","immutableChildren","obj","forEach","key","fromJS","initialState","context"],"mappings":";;AAAA,OAAOA,SAAP,MAAsB,WAAtB;AACA,OAAOC,eAAP,MAA4B,aAA5B;AACA,SAASC,YAAT,QAA6B,cAA7B;AACA,SAASC,mBAAT,QAAoC,0BAApC;AACA,SAASC,WAAT,EAAsBC,eAAtB,QAA6C,OAA7C;AAEA,OAAOC,MAAP;AACA,OAAOC,WAAP;;AAEA,SAASC,iBAAT,OAA0C;AAAA,MAAZC,QAAY,QAAZA,QAAY;AACxC,MAAIC,WAAW,GAAG,CAChBT,eADgB,CAAlB;;AAIA,MAAIK,MAAM,CAACK,GAAP,KAAe,aAAf,QAAJ,EAAmE;AACjED,IAAAA,WAAW,CAACE,IAAZ,CAAiBV,YAAY,CAAC;AAC5BW,MAAAA,KAAK,EAAE,MADqB;AAE5BC,MAAAA,SAAS,EAAE,IAFiB;AAG5BC,MAAAA,gBAAgB,EAAE,0BAACC,KAAD,EAAW;AAC3B,YAAIC,QAAQ,GAAG,EAAf;;AAEA,wCAAc,cAAYD,KAAZ,CAAd,kCAAkC;AAA7B,cAAIE,CAAC,mBAAL;;AACH,cAAIlB,SAAS,CAACmB,QAAV,CAAmBC,UAAnB,CAA8BJ,KAAK,CAACE,CAAD,CAAnC,CAAJ,EAA6C;AAC3CD,YAAAA,QAAQ,CAACC,CAAD,CAAR,GAAcF,KAAK,CAACE,CAAD,CAAL,CAASG,IAAT,EAAd;AACD,WAFD,MAEO;AACLJ,YAAAA,QAAQ,CAACC,CAAD,CAAR,GAAcF,KAAK,CAACE,CAAD,CAAnB;AACD;AACF;;AAED,eAAOD,QAAP;AACD;AAf2B,KAAD,CAA7B;AAiBD;;AAED,SAAOP,WAAP;AACD;;AAED,SAASY,iBAAT,CAA4BC,GAA5B,EAAiC;AAC/B,MAAIP,KAAK,GAAG,EAAZ;;AACA,gBAAYO,GAAZ,EAAiBC,OAAjB,CAAyB,UAACC,GAAD,EAAS;AAChCT,IAAAA,KAAK,CAACS,GAAD,CAAL,GAAazB,SAAS,CAAC0B,MAAV,CAAiBH,GAAG,CAACE,GAAD,CAApB,CAAb;AACD,GAFD;;AAGA,SAAOT,KAAP;AACD;;AAED,gBAAe,YAAgC;AAAA,MAA/BW,YAA+B,uEAAhB,EAAgB;AAAA,MAAZC,OAAY;AAAA,MACvCnB,QADuC,GAC1BmB,OAD0B,CACvCnB,QADuC;AAE7C,MAAIC,WAAW,GAAGF,iBAAiB,CAAC;AAAEC,IAAAA,QAAQ,EAARA;AAAF,GAAD,CAAnC;AACA,MAAIO,KAAK,GAAGM,iBAAiB,CAACK,YAAD,CAA7B;AAEA,SAAOvB,WAAW,CAChBG,WADgB,EAEhBS,KAFgB,EAGhBb,mBAAmB,CAACE,eAAe,MAAf,4BAAmBK,WAAnB,EAAD,CAHH,CAAlB;AAKD,CAVD","sourcesContent":["import Immutable from 'immutable'\r\nimport thunkMiddleware from 'redux-thunk'\r\nimport { createLogger } from 'redux-logger'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\nimport { createStore, applyMiddleware } from 'redux'\r\n\r\nimport config from 'config'\r\nimport rootReducer from '../reducers'\r\n\r\nfunction createMiddlewares ({ isServer }) {\r\n  let middlewares = [\r\n    thunkMiddleware\r\n  ]\r\n\r\n  if (config.env === 'development' && typeof window !== 'undefined') {\r\n    middlewares.push(createLogger({\r\n      level: 'info',\r\n      collapsed: true,\r\n      stateTransformer: (state) => {\r\n        let newState = {}\r\n\r\n        for (let i of Object.keys(state)) {\r\n          if (Immutable.Iterable.isIterable(state[i])) {\r\n            newState[i] = state[i].toJS()\r\n          } else {\r\n            newState[i] = state[i]\r\n          }\r\n        }\r\n\r\n        return newState\r\n      }\r\n    }))\r\n  }\r\n\r\n  return middlewares\r\n}\r\n\r\nfunction immutableChildren (obj) {\r\n  let state = {}\r\n  Object.keys(obj).forEach((key) => {\r\n    state[key] = Immutable.fromJS(obj[key])\r\n  })\r\n  return state\r\n}\r\n\r\nexport default (initialState = {}, context) => {\r\n  let { isServer } = context\r\n  let middlewares = createMiddlewares({ isServer })\r\n  let state = immutableChildren(initialState)\r\n\r\n  return createStore(\r\n    rootReducer,\r\n    state,\r\n    composeWithDevTools(applyMiddleware(...middlewares))\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}